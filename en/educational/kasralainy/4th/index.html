<!DOCTYPE html>
<html id="html-root" lang="en" class="dark">
<head>
        <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2PD3975NL9"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-2PD3975NL9');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fourth Year - Kasr Al-Ainy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    colors: { medical: { 50: '#f0f9ff', 100: '#e0f2fe', 500: '#0ea5e9', 600: '#0284c7', 700: '#0369a1', 800: '#075985', 900: '#0c4a6e' }, gold: { 400: '#fbbf24', 500: '#f59e0b', 600: '#d97706' } },
                    animation: { 'bounce-drop': 'bounceDrop 0.6s cubic-bezier(0.25, 1, 0.5, 1)', 'fade-in': 'fadeIn 0.3s ease-in-out', 'shake': 'shake 0.4s cubic-bezier(.36,.07,.19,.97) both' },
                    keyframes: { bounceDrop: { '0%': { transform: 'translateY(-500%)', opacity: '0' }, '60%': { transform: 'translateY(0)', opacity: '1' }, '75%': { transform: 'translateY(-20px)' }, '100%': { transform: 'translateY(0)' } }, fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } }, shake: { '10%, 90%': { transform: 'translate3d(-1px, 0, 0)' }, '20%, 80%': { transform: 'translate3d(2px, 0, 0)' }, '30%, 50%, 70%': { transform: 'translate3d(-4px, 0, 0)' }, '40%, 60%': { transform: 'translate3d(4px, 0, 0)' } } }
                }
            }
        }
    </script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>.no-scrollbar::-webkit-scrollbar { display: none; } .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; } .ladder-step.active { background: #0ea5e9; color: white; transform: scale(1.05); font-weight: 800; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); border-color: white; } .ladder-step.completed { opacity: 0.5; } .ladder-step.safe-haven { color: #fbbf24; } .ladder-step.active.safe-haven { color: white; background: #d97706; }</style>
</head>
<body class="bg-gray-100 dark:bg-slate-950 text-slate-800 dark:text-slate-100 h-screen overflow-hidden flex flex-col md:flex-row text-xs md:text-sm">
    <!-- Config Injection -->
    <script>
        window.gameConfig = {
            lang: 'en',
            category: 'educational', // Logic will likely default to mixed/educational
            basePath: '../../../../', // Deep linking fix
            availableTopics: []
        };
    </script>

    <!-- Sidebar -->
    <aside id="sidebar" class="fixed inset-y-0 z-[75] w-56 bg-white dark:bg-slate-900 shadow-2xl transition-transform duration-300 flex flex-col border-r border-slate-200 dark:border-slate-800 transform">
        <div id="sidebar-review-container" class="transition-all duration-500 ease-in-out overflow-hidden max-h-0 opacity-0 px-2 bg-slate-50 dark:bg-slate-900/50">
             <button onclick="openReviewHistory()" class="w-full bg-slate-200 dark:bg-slate-800 hover:bg-slate-300 dark:hover:bg-slate-700 text-slate-700 dark:text-slate-200 font-bold py-2 rounded-lg transition-all flex items-center justify-center gap-2 text-xs my-2 shadow-sm border border-slate-300 dark:border-slate-700">
                <span data-i18n="reviewHistory">Review History</span>
            </button>
        </div>
        <div class="p-2 border-b border-slate-200 dark:border-slate-800 flex justify-between items-center bg-slate-50 dark:bg-slate-900/50 h-12">
            <h2 class="text-sm font-bold flex items-center gap-2 text-slate-800 dark:text-white">
                <i data-lucide="history" class="w-4 h-4 text-medical-500"></i>
                <span data-i18n="sessionHistory">Session History</span>
            </h2>
            <button onclick="toggleSidebar()" class="md:hidden p-1 rounded-lg hover:bg-slate-200 dark:hover:bg-slate-800 transition-colors"><i data-lucide="x" class="w-4 h-4"></i></button>
        </div>
        <div id="history-container" class="flex-1 overflow-y-auto p-1.5 space-y-1.5 no-scrollbar bg-slate-50/50 dark:bg-slate-950/50">
            <div class="text-center text-slate-400 text-[10px] mt-10 italic" data-i18n="noHistory">No questions answered yet.</div>
        </div>
    </aside>

    <!-- Main Content -->
    <main id="main-content" class="flex-1 flex flex-col h-full relative transition-all duration-300 ml-56">
        <header class="h-12 bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-800 flex items-center justify-between px-3 shrink-0 shadow-sm z-30">
            <div class="flex items-center gap-2">
                <button onclick="toggleSidebar()" class="p-1.5 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-600 dark:text-slate-300 transition-colors"><i data-lucide="panel-left" class="w-4 h-4"></i></button>
                <a href="../" class="flex items-center gap-2 hover:opacity-80 transition-opacity">
                    <div class="bg-gradient-to-br from-orange-500 to-orange-700 text-white p-1 rounded-lg shadow-lg shadow-orange-500/30"><i data-lucide="graduation-cap" class="w-4 h-4"></i></div>
                    <div>
                        <h1 class="font-bold text-sm leading-tight hidden sm:block">Fourth Year <span class="text-orange-500">Kasr Al-Ainy</span></h1>
                        <p class="text-[9px] uppercase font-bold text-slate-400 tracking-wider hidden sm:block">Educational Hub</p>
                    </div>
                </a>
            </div>
            <div class="flex items-center gap-2">
                <button onclick="toggleTheme()" class="p-1.5 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors text-slate-500 dark:text-slate-400"><i data-lucide="moon" class="w-4 h-4 hidden dark:block"></i><i data-lucide="sun" class="w-4 h-4 block dark:hidden"></i></button>
                <button onclick="initGameSetup()" class="bg-medical-600 hover:bg-medical-700 text-white px-2.5 py-1 rounded-lg text-xs font-bold shadow-lg shadow-medical-500/20 transition-all hover:scale-105 active:scale-95 flex items-center gap-1.5"><i data-lucide="rotate-ccw" class="w-3 h-3"></i><span class="hidden sm:inline" data-i18n="newSession">New Session</span></button>
            </div>
        </header>

        <div class="flex-1 overflow-hidden relative flex flex-col items-center justify-start bg-slate-100 dark:bg-slate-950 p-1 md:p-2 gap-1 w-full">
            <div id="strategy-ui" class="w-full flex flex-col items-center gap-1 h-full justify-center hidden"><div id="scoreboard" class="w-full max-w-4xl flex justify-center gap-1.5 px-1 overflow-x-auto no-scrollbar py-0.5 min-h-[50px] shrink-0"></div><div class="relative bg-blue-600 dark:bg-blue-900 p-2 rounded-xl shadow-xl shadow-blue-900/40 border-4 border-blue-500